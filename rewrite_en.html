<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>rewrite_en</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h3 id="toc_0">Rewrite Rules</h3>

<p>Rewrite rules consist of two parts: <code>matching rules</code> (which requests to perform rewrites on) and <code>rewrite rules</code> (how to rewrite them).</p>

<h3 id="toc_1">Host Rewrite</h3>

<p>Host rewrite is used to change the target address and port number of a request, and to determine whether to use SSL/TLS encryption. This type of rule is very useful for frequent switching between test and production server addresses during testing.</p>

<h3 id="toc_2">Path Rewrite</h3>

<p>HTTP path refers to the part of the HTTP URL after the hostname, which is used to identify the path of the resource location on the web server.</p>

<div><pre><code class="language-none">https://example.com/api/user?name=john&amp;age=25</code></pre></div>

<p>In this example, <code>/api/user</code> is the path, which usually begins with a <code>/</code>. When rewriting the path, you need to replace the entire path, and the rule you fill in must also begin with a <code>/</code>. If you want to replace the path with an empty string, simply fill in <code>/</code>.</p>

<h3 id="toc_3">Query Rewrite</h3>

<p>HTTP query is a technique for passing data through a URL, allowing parameters and values to be passed through the URL of an HTTP request using the &quot;?&quot; symbol. A query consists of one or more key-value pairs separated by the &quot;&amp;&quot; symbol.</p>

<p>For example, the following URL contains a query string with two parameters (name and age):</p>

<div><pre><code class="language-none">https://example.com/api/user?name=john&amp;age=25</code></pre></div>

<p>In this example, <code>name=john&amp;age=25</code> is the query string, which is a series of key-value pairs separated by &quot;&amp;&quot;. When rewriting, Hodor will parse the query into key-value pairs similar to a dictionary (in reality, it&#39;s more complicated because it has to handle order and array situations), and then modify the corresponding keys and values. Additionally, these parameter names and values should be URL encoded. For example, &quot;value 1&quot; will be encoded as &quot;value%201&quot;. However, Hodor will automatically handle these conversions for you, so you don&#39;t need to do any extra processing.</p>

<h3 id="toc_4">Header Rewrite</h3>

<p>HTTP Header is a set of key-value pairs, and you can add or delete certain values to the HTTP Header. However, there are several fields that need special handling, including Range, Content-Range, Content-Length, Content-Encoding, Content-Transfer-Encoding, and Transfer-Encoding. These fields are controlled by the system and will not be affected by manual entries. If you fill in the Content-Type, it will override the system&#39;s mime-type setting.</p>

<h3 id="toc_5">Body Rewrite</h3>

<p>HTTP Body can be encoded in many different ways. Hodor supports three encoding methods to modify key-value pairs: JSON, x-www-form-urlencoded, and multipart/form-data. Of course, you can also replace the entire body part dynamically. You only need to prepare the data in advance, and when the corresponding request is matched, Hodor will replace the body.</p>

<h4 id="toc_6">Decode and Modify as JSON</h4>

<p>JSON rewriting works by matching the KeyPath and replacing or adding the Value, or deleting the corresponding Key and Value.</p>

<h5 id="toc_7">1. What is KeyPath?</h5>

<p>JSON modification can replace or delete a value by means of a KeyPath.<br>
KeyPath represents a JSON access path string designed using the keywords &quot;.&quot;, &quot;<em>&quot;, &quot;[]&quot;, with &quot;.&quot; used for dictionary extraction, &quot;</em>&quot; and &quot;[]&quot; used for array extraction.</p>

<div><pre><code class="language-none">{
 &quot;A&quot;: &quot;a1&quot;, 
 &quot;B&quot;: {
    &quot;B1&quot;: &quot;bbbb&quot;, // String type
    &quot;B2&quot;: 110  // Int type
 }, 
 &quot;C&quot;: [{
        &quot;C1&quot;: &quot;cccc&quot;
    }, 
    {
        &quot;C1&quot;: &quot;ccccc&quot;
    }]
}</code></pre></div>

<p>For example, if you want to access the value of B2, your KeyPath should be like this:
<code>B.B2</code><br>
If you want to access the value of the first C1, your KeyPath should be like this:
<code>C[0].C1</code>  // where 0 is the array index
If you want to locate all C1, your KeyPath should be like this:
<code>C[*].C1</code> // where * is a wildcard, matching all content in the array</p>

<h5 id="toc_8">2. JSON-encoded data has types, so the data type of the corresponding value should be specified when modifying the data.</h5>

<p><em>auto type</em><br>
If the value type you set is auto, then the value will be automatically converted to the same data type as the original value. If the type conversion fails, an exception will be thrown and stored in the rewrite log. If there is no original value, it will be converted to a String type and inserted into the corresponding location.<br>
For example, if you want to replace the value of B2, the KeyPath should be set to <code>B.B2</code>, and the value you set should be <code>900</code>, with the data type set to <code>auto</code>. Then, this data will be automatically converted to an Int type.  </p>

<p><em>Specified value data type</em><br>
If you specify the data type of the modified value, then when adding or replacing the value, the value you set will be converted to the data type you specify before adding or replacing the corresponding value. Similarly, if the type conversion fails, an exception will be thrown and stored in the rewrite log.</p>

<h4 id="toc_9">Decode and Modify as x-www-form-urlencoded</h4>

<p>x-www-form-urlencoded rewriting is decoded into key-value pairs and works by matching Keys, replacing or adding Values, or deleting corresponding Keys and Values.</p>

<p>Specifically, in x-www-form-urlencoded, each parameter of the request is represented as &quot;key=value&quot;, with different parameters separated by the &quot;&amp;&quot; symbol. For example:</p>

<div><pre><code class="language-none">name=value1&amp;age=value2&amp;address=value3</code></pre></div>

<p>These parameter names and values need to be URL encoded, for example, &quot;value 1&quot; will be encoded as &quot;value%201&quot;. When rewriting, you don&#39;t need to manually process URL encoding, as the system will handle it automatically.</p>

<h4 id="toc_10">Decode and Modify as multipart/form-data</h4>

<p>HTTP multipart/form-data is a data format consisting of multiple parts, often used for client-server requests with file uploads.</p>

<p>In the multipart/form-data data format, each form item consists of an independent part, with parts separated by a boundary. Each part can include a header with associated content, such as text, binary data, etc. The headers usually contain keywords such as Content-Disposition and Content-Type to describe the type, name, and encoding of the part, and the body is the actual data carried.</p>

<p>The following is an example of a multipart/form-data data format:</p>

<div><pre><code class="language-none">POST /submit-form HTTP/1.1
Host: example.com
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Length: 248

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name=&quot;text&quot;

Hello World!
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name=&quot;image&quot;; filename=&quot;example.png&quot;
Content-Type: image/png

(binary data)
------WebKitFormBoundary7MA4YWxkTrZu0gW--</code></pre></div>

<p>The above example shows a multipart/form-data request containing two form items: text and image. The text form item is plain text, whereas the image form item contains a file named example.png. The text and file data are located in different parts, with each part having its own content-type, name, and body content.</p>

<p>When rewriting, name and filename in the rewrite rules correspond to the Content-Disposition&#39;s name and filename. Hodor only supports the modification of name and corresponding content.</p>

<h3 id="toc_11">Code Rewrite</h3>

<p>Hodor can change HTTP status codes and redirect through HTTP response codes. You can choose 301, 302, 307, and 308 codes to configure the redirect address.</p>

<h3 id="toc_12">Mock</h3>

<p>Mock is mainly used to return specific content for a particular request. You can understand it as a local HTTP server that returns set content for matched requests.</p>

<p><strong><em>Finally, Due to the various combinations of transmission control in the HTTP protocol, the author may have overlooked some aspects during testing. If you find that a certain function is not working according to the documentation or does not meet your expectations, please contact us via email at <code>hodorsoft@outlook.com</code>. Writing this software was not easy, and if you find it useful, we hope you can leave a positive review on the AppStore. Your support is our greatest motivation for future updates.</em></strong></p>




</body>

</html>
